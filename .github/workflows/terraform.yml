 name: "Terraform"

 env:
   TF_TOKEN_terraform_adarshasuvarna_in: ${{ secrets.TF_API_TOKEN }}
 on:
   push:
     branches:
       - main
   pull_request:
 jobs:
   Terraform:
     name: "Terraform"
     runs-on: self-hosted
     steps:
       - name: Checkout
         uses: actions/checkout@v3

       - name : Terraform Format
         id: fmt   
         run: terraform fmt -check

       - name: Terraform Init
         id: init
         run: terraform init

       - name: Terraform Validate  
         id: validate
         run: terraform validate -no-color
               
       - name: Terraform Plan
         id: plan
         run: terraform plan

       - name: Terraform Apply
         id: apply
         run: terraform apply --auto-approve